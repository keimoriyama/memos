# pytorchの学習メモ

[公式ドキュメント](https://pytorch.org/)

## Tensors

`Tensors`はnumpyのndarraysのようなもの。GPUの高速計算にも対応している

```a.py
from __future__ import print_function
import torch
# 空の行列を用意する
x = torch.empty(5, 3)
# 乱数で初期化する
x = torch.rand(5, 3)
# 全部0で初期化する
x = torch.zeros(5, 3)
# 行列の表示
print(x)
```

実行結果

```
tensor([[3.7749e+07, 5.5351e-43, 3.7749e+07],
        [5.5351e-43, 3.7755e+07, 5.5351e-43],
        [3.7755e+07, 5.5351e-43, 3.7749e+07],
        [5.5351e-43, 3.7749e+07, 5.5351e-43],
        [3.7761e+07, 5.5351e-43, 3.7761e+07]])
```

### Tensorの整形

`view`を使って行列を変形する

```a.py
>>> import torch
# 2*3の行列を用意する
>>> tensor = torch.randn(2, 3)
>>> tensor
tensor([[ 0.3013,  0.3646, -0.9593],
        [-0.0480,  0.1740, -0.1913]])
# view(-1)を使って整形する
# -1を指定することで3列目について整形する
>>> tensor.view(-1)
tensor([ 0.3013,  0.3646, -0.9593, -0.0480,  0.1740, -0.1913])
```

3次元ベクトルの場合

```3.py
>>> tensor = torch.randn(2, 3, 6)
>>> tensor
tensor([[[-0.2628, -0.2240, -0.7432,  1.0379,  0.1950, -0.1667],
         [ 1.0881, -1.3687, -1.0729, -0.2489, -0.1718,  0.2478],
         [ 0.2421,  0.8694, -0.3833,  1.6207, -0.0830,  1.1718]],
        [[-1.2902, -1.3568, -1.1205, -1.0146, -0.3195,  0.3178],
         [-0.6977, -0.2991,  0.8975, -0.2129,  2.0905,  0.8213],
         [ 0.4007, -0.6129, -0.6583,  0.2298,  0.1762,  0.0192]]])
# 3つ目の次元について整形する
>>> tensor.view(-1, tensor.shape[-1])
tensor([[-0.2628, -0.2240, -0.7432,  1.0379,  0.1950, -0.1667],
        [ 1.0881, -1.3687, -1.0729, -0.2489, -0.1718,  0.2478],
        [ 0.2421,  0.8694, -0.3833,  1.6207, -0.0830,  1.1718],
        [-1.2902, -1.3568, -1.1205, -1.0146, -0.3195,  0.3178],
        [-0.6977, -0.2991,  0.8975, -0.2129,  2.0905,  0.8213],
        [ 0.4007, -0.6129, -0.6583,  0.2298,  0.1762,  0.0192]])
>>> tensor.shape[-1]
6
```
