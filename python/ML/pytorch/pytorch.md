# pytorchの学習メモ

[公式ドキュメント](https://pytorch.org/)

## Tensors

`Tensors`はnumpyのndarraysのようなもの。GPUの高速計算にも対応している

```a.py
from __future__ import print_function
import torch
# 空の行列を用意する
x = torch.empty(5, 3)
# 乱数で初期化する
x = torch.rand(5, 3)
# 全部0で初期化する
x = torch.zeros(5, 3)
# 行列の表示
print(x)
```

実行結果

```
tensor([[3.7749e+07, 5.5351e-43, 3.7749e+07],
        [5.5351e-43, 3.7755e+07, 5.5351e-43],
        [3.7755e+07, 5.5351e-43, 3.7749e+07],
        [5.5351e-43, 3.7749e+07, 5.5351e-43],
        [3.7761e+07, 5.5351e-43, 3.7761e+07]])
```

### Tensorの整形

`view`を使って行列を変形する

```a.py
>>> import torch
# 2*3の行列を用意する
>>> tensor = torch.randn(2, 3)
>>> tensor
tensor([[ 0.3013,  0.3646, -0.9593],
        [-0.0480,  0.1740, -0.1913]])
# view(-1)を使って整形する
# -1を指定することで2列目について整形する(2次元->1次元)
>>> tensor.view(-1)
tensor([ 0.3013,  0.3646, -0.9593, -0.0480,  0.1740, -0.1913])
```

3次元ベクトルの場合

```3.py
# 2*3*4の大きさのベクトルを生成
>>> tensor = torch.randn(2, 3, 4)
>>> tensor
tensor([[[-0.3703, -0.7691, -2.0003,  0.1381],
         [ 0.7687,  0.4049, -0.0618,  0.6874],
         [-1.3310,  0.6907,  0.3392, -0.4405]],

        [[-0.1123, -1.2040, -0.6038, -1.1603],
         [ 0.3762, -1.4115,  0.7040, -0.7797],
         [-0.3302,  0.9706, -0.6817,  0.3717]]])
>>> tensor.view(-1)
tensor([-0.3703, -0.7691, -2.0003,  0.1381,  0.7687,  0.4049, -0.0618,  0.6874,
        -1.3310,  0.6907,  0.3392, -0.4405, -0.1123, -1.2040, -0.6038, -1.1603,
         0.3762, -1.4115,  0.7040, -0.7797, -0.3302,  0.9706, -0.6817,  0.3717])
>>> tensor.view(-1).size()
torch.Size([24])
>>> tensor.shape[-1]
4
>>> tensor.view(-1, tensor.shape[-1])
tensor([[-0.3703, -0.7691, -2.0003,  0.1381],
        [ 0.7687,  0.4049, -0.0618,  0.6874],
        [-1.3310,  0.6907,  0.3392, -0.4405],
        [-0.1123, -1.2040, -0.6038, -1.1603],
        [ 0.3762, -1.4115,  0.7040, -0.7797],
        [-0.3302,  0.9706, -0.6817,  0.3717]])
>>> tensor.view(-1, tensor.shape[-1]).size()
torch.Size([6, 4])
```
